      <!-- Font Awesome Icon -->
      <script src="https://kit.fontawesome.com/7cc967098c.js" crossorigin="anonymous"></script>
      <!-- Iconify -->
      <script src="https://cdn.jsdelivr.net/npm/@iconify/iconify@2.2.1/dist/iconify.min.js"></script>
      <!-- jQuery -->
      <script src="/adminlte/plugins/jquery/jquery.min.js"></script>
      <!-- jQuery UI 1.11.4 -->
      <script src="/adminlte/plugins/jquery-ui/jquery-ui.min.js"></script>
      <script> $.widget.bridge('uibutton', $.ui.button) </script>
      <!-- Bootstrap 4 -->
      <script src="/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
      <!-- AdminLTE App -->
      <script src="/adminlte/dist/js/adminlte.js"></script>

      <!-- DataTables  & Plugins -->
      <script src="/adminlte/plugins/datatables/jquery.dataTables.min.js"></script>
      <script src="/adminlte/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
      <script src="/adminlte/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
      <script src="/adminlte/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
      <script src="/adminlte/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
      <script src="/adminlte/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
      <script src="/adminlte/plugins/jszip/jszip.min.js"></script>
      <script src="/adminlte/plugins/pdfmake/pdfmake.min.js"></script>
      <script src="/adminlte/plugins/pdfmake/vfs_fonts.js"></script>
      <script src="/adminlte/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
      <script src="/adminlte/plugins/datatables-buttons/js/buttons.print.min.js"></script>
      <script src="/adminlte/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>

      <script>
        // Namespace kecil buat aksi umum
        window.HIFIAdmin = {
          refreshData: () => { window.location.reload(); }
        };

        // Counter animasi untuk kartu stat
        document.addEventListener('DOMContentLoaded', () => {
          document.querySelectorAll('[data-counter]').forEach(el => {
            const target = Number(el.getAttribute('data-counter') || 0);
            let cur = 0;
            const step = Math.max(1, Math.round(target / 50));
            const tick = () => {
              cur = Math.min(target, cur + step);
              el.textContent = cur.toLocaleString('id-ID');
              if (cur < target) requestAnimationFrame(tick);
            };
            tick();
          });
        });

        // Inisialisasi DataTable untuk #usersTable (dashboard)
        $(function(){
          const $tbl = $('#usersTable');
          if (!$tbl.length) return;

          const table = $tbl.DataTable({
            responsive: true,
            autoWidth: false,
            searching: true,       // tetap aktif; kita kontrol via input custom
            lengthChange: false,   // length default disembunyikan; pakai dropdown custom
            pageLength: 10,
            lengthMenu: [[10,20,30,50,100,-1],[10,20,30,50,100,'All']],
            pagingType: 'full_numbers',
            columnDefs: [
              { targets: 'no-export', orderable: false, searchable: false }
            ],
            order: [[1,'asc']], // urut Username
            dom: 't<"dt-bottom"ip>', // hanya table + info & paging default (kita tambah toolbar custom)
          });

          // ===== Toolbar: Search kolom Nama (kolom index 2) =====
          $('#searchNama').on('input', function(){
            table.column(2).search(this.value).draw();
          });

          // ===== Toolbar: Items per page =====
          $('#itemsPerPage').on('change', function(){
            const v = parseInt(this.value, 10) || 10;
            table.page.len(v).draw();
          });

          // ===== Toolbar: Page selector =====
          function buildPageSelect(){
            const info = table.page.info();      // {page, pages, ...}
            const $sel = $('#pageSelect').empty();
            for (let i=0; i<info.pages; i++){
              const opt = new Option(`Page ${i+1}`, i, false, i===info.page);
              $sel.append(opt);
            }
            $('#totalPages').text(info.pages || 1);
          }
          buildPageSelect();
          table.on('draw.dt', buildPageSelect);

          $('#pageSelect').on('change', function(){
            const idx = parseInt(this.value, 10) || 0;
            table.page(idx).draw('page');
          });

          // ===== Row detail (klik baris untuk info singkat) =====
          $('#usersTable tbody').on('click', 'tr', function(e){
            // Hindari trigger saat klik tombol aksi
            if ($(e.target).closest('.btn-action, button, a, i').length) return;

            const tr = $(this);
            const row = table.row(tr);

            if (row.child.isShown()) {
              row.child.hide();
              tr.removeClass('shown');
              return;
            }

            const tds = tr.children('td');
            const data = {
              no: tds.eq(0).text().trim(),
              username: tds.eq(1).text().trim(),
              nama: tds.eq(2).text().trim(),
              npm: tds.eq(3).text().trim(),
              email: tds.eq(4).text().trim(),
              roleText: tds.eq(5).text().trim(),
              update: tds.eq(6).text().trim(),
              id: tr.data('id')
            };

            const badgeClass = data.roleText.toLowerCase() === 'admin' ? 'badge-red' : 'badge-blue';
            const detailHTML = `
              <div class="dt-detail">
                <div class="detail-card">
                  <div class="detail-item"><b>Username</b><span>${data.username || '-'}</span></div>
                  <div class="detail-item"><b>Nama</b><span>${data.nama || '-'}</span></div>
                  <div class="detail-item"><b>NPM</b><span>${data.npm || '-'}</span></div>
                  <div class="detail-item"><b>Email</b><span>${data.email || '-'}</span></div>
                  <div class="detail-item"><b>Role</b>
                    <span class="badge-glass ${badgeClass}">${data.roleText || '-'}</span>
                  </div>
                  <div class="detail-item"><b>Update</b><span>${data.update || '-'}</span></div>
                  <div class="detail-actions">
                    <a class="btn-primary-gradient" href="/dashboard/edit/${data.id}" title="Edit data">
                      <i class="fas fa-edit"></i> Edit Data
                    </a>
                  </div>
                </div>
              </div>
            `;

            row.child(detailHTML).show();
            tr.addClass('shown');
          });
        });
      </script>

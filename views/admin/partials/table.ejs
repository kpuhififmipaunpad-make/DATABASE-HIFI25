<!-- =========================
     TABLE.EJS (Dashboard)
     ========================= -->
<style>
  /* =========================================================
     TOOLBAR STYLING
     ========================================================= */
  .table-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 16px;
    margin-bottom: 24px;
    flex-wrap: wrap;
    padding: 20px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    border: 1px solid rgba(30, 58, 138, 0.1);
  }
  .toolbar-left { display: flex; align-items: center; gap: 12px; }
  .toolbar-label { font-weight: 600; color: #374151; font-size: 14px; }
  .toolbar-select {
    background: rgba(255, 255, 255, 0.95);
    border: 2px solid #E5E7EB;
    border-radius: 12px;
    padding: 10px 16px;
    font-size: 14px;
    color: #1F2937;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 140px;
  }
  .toolbar-select:hover { border-color: #1E3A8A; }
  .toolbar-select:focus {
    outline: none; border-color: #1E3A8A;
    box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
  }
  .toolbar-right { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
  .toolbar-search {
    background: rgba(255, 255, 255, 0.95);
    border: 2px solid #E5E7EB;
    border-radius: 12px;
    padding: 10px 16px;
    font-size: 14px;
    color: #1F2937;
    transition: all 0.3s ease;
    min-width: 250px;
  }
  .toolbar-search:focus {
    outline: none; border-color: #1E3A8A;
    box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
  }
  .toolbar-search::placeholder { color: #9CA3AF; }

  .btn-glass {
    background: rgba(255, 255, 255, 0.95);
    border: 2px solid #1E3A8A;
    color: #1E3A8A;
    border-radius: 12px;
    padding: 10px 20px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex; align-items: center; gap: 8px;
  }
  .btn-glass:hover {
    background: #1E3A8A; color: white; transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
  }
  #exportButtons { display: flex; gap: 8px; }

  /* DataTables Buttons - Green Theme */
  .dt-btn-green{
    background: linear-gradient(135deg, #10B981 0%, #059669 100%) !important;
    color: white !important; border: none !important;
    border-radius: 12px !important; padding: 10px 16px !important;
    font-weight: 600 !important; cursor: pointer !important;
    transition: all 0.3s ease !important;
    display: inline-flex !important; align-items: center !important; gap: 8px !important;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3) !important;
  }
  .dt-btn-green:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4) !important;
  }

  /* =========================================================
     PAGINATION STYLING
     ========================================================= */
  .dt-bottom {
    display: flex; justify-content: space-between; align-items: center;
    gap: 12px; padding-top: 24px; margin-top: 24px;
    border-top: 2px solid rgba(0, 0, 0, 0.05); flex-wrap: wrap;
  }
  .dataTables_info { color: #374151 !important; font-weight: 600 !important; font-size: 14px !important; }
  .dataTables_paginate { display: flex; gap: 4px; }
  .dataTables_paginate .paginate_button {
    background: rgba(255, 255, 255, 0.95) !important;
    border: 2px solid #E5E7EB !important; border-radius: 10px !important;
    color: #374151 !important; padding: 8px 14px !important; margin: 0 !important;
    font-weight: 600 !important; transition: all 0.3s ease !important; cursor: pointer !important;
  }
  .dataTables_paginate .paginate_button:hover:not(.disabled) {
    background: rgba(30, 58, 138, 0.1) !important;
    color: #1E3A8A !important; border-color: #1E3A8A !important; transform: translateY(-2px) !important;
  }
  .dataTables_paginate .paginate_button.current {
    background: linear-gradient(135deg, #DC143C 0%, #1E3A8A 100%) !important;
    color: white !important; border: none !important;
    box-shadow: 0 4px 12px rgba(220, 20, 60, 0.3) !important;
  }
  .dataTables_paginate .paginate_button.disabled {
    opacity: 0.5 !important; cursor: not-allowed !important;
    background: rgba(255, 255, 255, 0.5) !important;
  }

  /* =========================================================
     DETAIL ROW (PREVIEW BIODATA)
     ========================================================= */
  #usersTable tbody tr.clickable-row { cursor: pointer; transition: all 0.3s ease; }
  #usersTable tbody tr.clickable-row:hover { background: rgba(30, 58, 138, 0.05); }
  #usersTable tbody tr.shown { background: rgba(220, 20, 60, 0.05) !important; }

  .dt-detail { padding: 24px; background: #F9FAFB; animation: fadeInUp 0.4s ease-out; }
  .detail-card {
    background: white; border-radius: 16px; padding: 24px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
  }
  .detail-item { background: #F9FAFB; padding: 16px; border-radius: 12px; border-left: 4px solid #DC143C; }
  .detail-item b {
    display: block; font-size: 12px; font-weight: 700; color: #6B7280;
    text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px;
  }
  .detail-item span { font-size: 14px; font-weight: 600; color: #1F2937; word-wrap: break-word; }

  .detail-actions {
    display: flex; gap: 12px; padding-top: 20px;
    border-top: 2px solid #E5E7EB; grid-column: 1 / -1;
  }
  .detail-actions .btn-primary-gradient {
    display: inline-flex; align-items: center; gap: 8px;
    padding: 12px 24px; text-decoration: none;
    box-shadow: 0 4px 12px rgba(220, 20, 60, 0.3);
  }
  .detail-actions .btn-primary-gradient:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(220, 20, 60, 0.4); }

  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* =========================================================
     RESPONSIVE
     ========================================================= */
  @media (max-width: 768px) {
    .table-toolbar { flex-direction: column; align-items: stretch; }
    .toolbar-left, .toolbar-right { width: 100%; justify-content: space-between; }
    .toolbar-search { min-width: 100%; }
    .detail-card { grid-template-columns: 1fr; }
    .dt-bottom { flex-direction: column; align-items: flex-start; }
  }
</style>

<!-- TOOLBAR ATAS -->
<div class="table-toolbar">
  <div class="toolbar-left">
    <span class="toolbar-label">Tampilkan</span>
    <select id="itemsPerPage" class="toolbar-select" aria-label="Items per page">
      <option value="10" selected>10 / page</option>
      <option value="25">25 / page</option>
      <option value="50">50 / page</option>
      <option value="100">100 / page</option>
      <option value="-1">Show All</option>
    </select>
  </div>

  <div class="toolbar-right">
    <input id="searchNama" class="toolbar-search" type="search" placeholder="🔍 Cari Nama..." aria-label="Cari Nama">
    <button id="btnRefresh" type="button" class="btn-glass">
      <i class="fas fa-sync-alt" aria-hidden="true"></i>
      Refresh
    </button>
    <div id="exportButtons" aria-label="Export Buttons"></div>
  </div>
</div>

<!-- TABEL -->
<table id="usersTable" class="display nowrap table-glass" style="width:100%">
  <thead>
    <tr>
      <th>No</th>
      <th>Username</th>
      <th>Nama</th>
      <th>NPM</th>
      <th>Email</th>
      <th>Telepon</th>
      <th>Role</th>
      <th>Terakhir Update</th>
      <th class="no-sort">Aksi</th>
    </tr>
  </thead>
  <tbody>
    <% users.forEach(function(u, i){ %>
      <tr
        class="clickable-row"
        data-id="<%= u._id %>"
        data-username="<%= u.username || '' %>"
        data-nama="<%= u.nama || '' %>"
        data-npm="<%= u.npm || '' %>"
        data-email="<%= u.email || '' %>"
        data-hp="<%= u.hp || '' %>"
        data-ttl="<%= u.ttl || '' %>"
        data-tgl="<%= u.tgl || '' %>"
        data-agama="<%= u.agama || '' %>"
        data-goldar="<%= u.goldar || '' %>"
        data-rumah="<%= u.rumah || '' %>"
        data-kos="<%= u.kos || '' %>"
        data-pendidikan="<%= u.pendidikan || '' %>"
        data-panitia="<%= u.panitia || '' %>"
        data-organisasi="<%= u.organisasi || '' %>"
        data-pelatihan="<%= u.pelatihan || '' %>"
        data-prestasi="<%= u.prestasi || '' %>"
      >
        <td><%= i + 1 %></td>
        <td><%= u.username %></td>
        <td><%= u.nama || '-' %></td>
        <td><%= u.npm || '-' %></td>
        <td><%= u.email || '-' %></td>
        <td><%= u.hp || '-' %></td>
        <td>
          <span class="badge-glass">
            <i class="fas fa-<%= (u.role === 'Admin') ? 'user-shield' : 'user' %>"></i>
            <%= (u.role || 'User') %>
          </span>
        </td>
        <td><%= u.updatedAt ? new Date(u.updatedAt).toLocaleDateString('id-ID') : '-' %></td>
        <td class="no-detail" onclick="event.stopPropagation()">
          <a class="btn-action btn-edit" title="Edit" href="/dashboard/edit/<%= u._id %>">
            <i class="fas fa-pen" aria-hidden="true"></i>
          </a>
          <form action="/dashboard/delete/<%= u._id %>?_method=DELETE" method="POST" style="display:inline">
            <button type="submit" class="btn-action btn-delete" title="Hapus"
              onclick="return confirm('Hapus data <%= u.nama || u.username %>?')">
              <i class="fas fa-trash" aria-hidden="true"></i>
            </button>
          </form>
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>

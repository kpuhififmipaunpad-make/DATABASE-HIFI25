<!DOCTYPE html>
<html lang="id">
<head>
  <%- include('partials/header') %>
  <style>
    body {
      background: linear-gradient(135deg, #1E3A8A 0%, #DC143C 100%);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
    }
    .wrapper { display: flex; min-height: 100vh; }
    .content-wrapper { flex: 1; margin-left: 260px; padding: 80px 30px 30px; transition: all 0.3s ease; }
    .content-wrapper.expanded { margin-left: 80px; }

    .dashboard-header { margin-bottom: 40px; animation: fadeInUp 0.6s ease-out; }
    .page-title { font-size: 32px; font-weight: 700; color: #fff; margin-bottom: 8px; text-shadow: 0 2px 10px rgba(0,0,0,.2); }
    .page-subtitle { color: rgba(255,255,255,.85); font-size: 16px; }

    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(250px,1fr)); gap: 24px; margin-bottom: 40px; }
    .stat-card { background: rgba(255,255,255,.95); backdrop-filter: blur(20px); border-radius: 20px; padding: 28px;
      box-shadow: 0 8px 32px rgba(0,0,0,.2); border: 1px solid rgba(255,255,255,.3); position: relative; overflow: hidden;
      transition: all .4s cubic-bezier(.68,-.55,.265,1.55);
    }
    .stat-card::before { content:''; position:absolute; inset:0 0 auto 0; height:4px; background:linear-gradient(90deg,#DC143C 0%,#1E3A8A 100%); }
    .stat-card:hover { transform: translateY(-6px) scale(1.01); box-shadow: 0 15px 40px rgba(0,0,0,.28); }
    .stat-icon { width: 60px; height: 60px; border-radius: 16px; display:flex; align-items:center; justify-content:center; font-size:28px; margin-bottom: 16px;
      background: linear-gradient(135deg,#DC143C 0%,#1E3A8A 100%); color:#fff; box-shadow: 0 4px 15px rgba(220,20,60,.3);
    }
    .stat-value { font-size: 36px; font-weight: 800; color: #111827; margin-bottom: 8px; letter-spacing:.3px; }
    .stat-label { color: #6B7280; font-size: 14px; font-weight: 600; }

    .table-container { background: rgba(255,255,255,.98); backdrop-filter: blur(18px); border-radius: 24px; padding: 24px 24px 18px;
      box-shadow: 0 20px 60px rgba(0,0,0,.3); border: 1px solid rgba(255,255,255,.35); animation: fadeInUp 1s ease-out;
    }
    .table-header { display:flex; justify-content: space-between; align-items:center; gap:12px; margin-bottom: 12px; flex-wrap: wrap; }
    .table-title { font-size: 22px; font-weight: 800; margin:0;
      background: linear-gradient(135deg,#DC143C 0%,#1E3A8A 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    }

    /* Toolbar */
    .table-toolbar { display:flex; gap:12px; align-items:center; flex-wrap: wrap; }
    .form-control-glass { background: rgba(255,255,255,.85); border: 1.5px solid rgba(15,23,42,.12); color:#111827;
      padding:10px 12px; border-radius:12px; font-size:14px; outline:none; transition: border-color .2s, box-shadow .2s;
    }
    .form-control-glass::placeholder{ color:#6b7280; }
    .form-control-glass:focus{ border-color:#1E3A8A; box-shadow:0 0 0 4px rgba(30,58,138,.12); }

    .btn-export, .btn-primary-gradient {
      display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; font-weight:700; letter-spacing:.2px;
      border: 1.5px solid rgba(15,23,42,.18); cursor:pointer; transition: transform .06s ease, box-shadow .2s ease, background .2s;
      background:#fff; color:#111827;
    }
    .btn-primary-gradient{ background: linear-gradient(135deg,#DC143C 0%,#1E3A8A 100%); color:#fff; border-color:transparent; }
    .btn-export:hover{ transform: translateY(-1px); box-shadow: 0 8px 22px rgba(0,0,0,.12); }
    .btn-primary-gradient:hover{ transform: translateY(-1px); box-shadow: 0 8px 24px rgba(30,58,138,.22); }

    /* DataTable theme (kontras tinggi) */
    table.dataTable thead { background: linear-gradient(135deg,#DC143C 0%,#1E3A8A 100%); }
    table.dataTable thead th { color:#fff; font-weight:700; padding:14px; border:none; font-size:13.5px; }
    table.dataTable thead th:first-child { border-top-left-radius: 10px; }
    table.dataTable thead th:last-child  { border-top-right-radius: 10px; }
    table.dataTable tbody td { color:#111827; font-size:14px; padding:14px; border:none; }
    table.dataTable tbody tr { border-bottom:1px solid rgba(0,0,0,.06); transition: background .15s, transform .12s; cursor:pointer; }
    table.dataTable tbody tr:hover { background: rgba(30,58,138,.06); }
    table.dataTable tbody tr.shown { background: rgba(220,20,60,.06); }

    /* Detail row */
    .dt-detail { padding:14px 16px 18px; }
    .detail-card {
      background: rgba(255,255,255,.95); border:1px solid rgba(15,23,42,.08); border-radius:16px; padding:16px;
      display:grid; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); gap:12px;
    }
    .detail-item b{ display:block; color:#1F2937; margin-bottom:4px; font-size:12px; text-transform:uppercase; letter-spacing:.4px;}
    .detail-item span{ color:#111827; font-weight:700; }
    .detail-actions{ display:flex; gap:10px; align-items:center; margin-top:6px; }
    .badge-glass { display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; font-weight:700; font-size:12px; }
    .badge-red { background: rgba(220,20,60,.1); color:#b10f31; border:1px solid rgba(220,20,60,.25); }
    .badge-blue{ background: rgba(30,58,138,.12); color:#1E3A8A; border:1px solid rgba(30,58,138,.25); }

    /* Footer paging area */
    .paging-tools { display:flex; gap:10px; align-items:center; padding:6px 0 0; flex-wrap:wrap; }
    .paging-tools small{ color:#374151; font-weight:600; }

    @media (max-width: 768px) {
      .content-wrapper { margin-left:0; padding:80px 15px 20px; }
      .table-container{ padding:18px; overflow-x:auto; }
      .table-header{ flex-direction:column; align-items:flex-start; gap:8px; }
      .table-toolbar{ width:100%; }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <%- include('partials/sidebar') %>
    <%- include('partials/navbar') %>

    <div class="content-wrapper">
      <!-- Header -->
      <div class="dashboard-header">
        <h1 class="page-title">Dashboard Admin</h1>
        <p class="page-subtitle">Selamat datang, <%= nama %>!</p>
      </div>

      <!-- Alerts -->
      <%- include('partials/message', {message: alert.message, status: alert.status}) %>

      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-card" data-tilt>
          <div class="stat-icon"><i class="fas fa-users"></i></div>
          <div class="stat-value" data-counter="<%= count.user %>">0</div>
          <div class="stat-label">Total Anggota</div>
        </div>
        <div class="stat-card" data-tilt>
          <div class="stat-icon"><i class="fas fa-user-shield"></i></div>
          <div class="stat-value" data-counter="<%= admin.length %>">0</div>
          <div class="stat-label">Administrator</div>
        </div>
        <div class="stat-card" data-tilt>
          <div class="stat-icon"><i class="fas fa-user-check"></i></div>
          <div class="stat-value" data-counter="<%= count.user - admin.length %>">0</div>
          <div class="stat-label">Anggota Aktif</div>
        </div>
        <div class="stat-card" data-tilt>
          <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
          <div class="stat-value">100%</div>
          <div class="stat-label">Database Aktif</div>
        </div>
      </div>

      <!-- Table -->
      <div class="table-container">
        <div class="table-header">
          <h2 class="table-title"><i class="fas fa-table"></i> Data Warga HIFI</h2>
          <div class="table-toolbar">
            <input id="searchNama" class="form-control-glass" type="text" placeholder="Cari Namaâ€¦ (kolom Nama saja)" aria-label="Cari Nama">
            <select id="itemsPerPage" class="form-control-glass" aria-label="Items per page">
              <option value="10" selected>10 / page</option>
              <option value="20">20 / page</option>
              <option value="30">30 / page</option>
              <option value="50">50 / page</option>
              <option value="100">100 / page</option>
            </select>
            <div class="paging-tools">
              <small>Page</small>
              <select id="pageSelect" class="form-control-glass" aria-label="Select page"></select>
              <small>/ <span id="totalPages">1</span></small>
            </div>
            <button onclick="HIFIAdmin.refreshData()" class="btn-export" id="refreshBtn" title="Refresh data">
              <i class="fas fa-sync-alt"></i> Refresh
            </button>
          </div>
        </div>

        <%- include('partials/table', {users: users}) %>
      </div>
    </div>
  </div>

  <%- include('partials/script') %>
  <script src="/javascript/animations.js"></script>
  <script src="/javascript/admin-animations.js"></script>
</body>
</html>

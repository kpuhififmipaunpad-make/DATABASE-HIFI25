<!DOCTYPE html>
<html lang="id">
<head>
    <%- include('partials/header') %>
    <title>Admin Dashboard | Database HIFI</title>
</head>
<body class="is-desktop">
    <!-- Background Shapes -->
    <div class="bg-shape bg-shape-1"></div>
    <div class="bg-shape bg-shape-2"></div>
    <div class="bg-shape bg-shape-3"></div>

    <!-- Navbar -->
    <%- include('partials/navbar') %>

    <!-- Sidebar -->
    <%- include('partials/sidebar') %>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <div class="container-glass">
            <!-- Alert Messages -->
            <%- include('partials/message') %>

            <!-- Page Header -->
            <div class="page-header" style="margin-bottom: 32px;">
                <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap; justify-content: space-between;">
                    <div>
                        <h1 class="text-gradient" style="font-size: 32px; margin: 0 0 8px 0; font-weight: 800;">
                            <i class="fas fa-tachometer-alt" style="margin-right: 12px;"></i>Dashboard Admin
                        </h1>
                        <p style="color: #6B7280; margin: 0; font-size: 14px; font-weight: 500;">
                            Selamat datang, <strong style="color: #1E3A8A;"><%= nama %></strong> ðŸ‘‹
                        </p>
                    </div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                        <button class="btn-glass" onclick="refreshData()" style="display: inline-flex; align-items: center; gap: 8px;">
                            <i class="fas fa-sync-alt"></i>
                            <span>Refresh</span>
                        </button>
                        <a href="/profile" class="btn-primary-gradient" style="text-decoration: none; display: inline-flex; align-items: center; gap: 8px;">
                            <i class="fas fa-user-circle"></i>
                            <span>Profil Saya</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Statistics Cards -->
            <div class="grid-responsive" style="margin-bottom: 32px;">
                <!-- Total Users Card -->
                <div class="stat-card">
                    <div class="stat-card-icon" style="background: linear-gradient(135deg, #3B82F6 0%, #1E3A8A 100%);">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3 style="font-size: 14px; color: #6B7280; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                        Total Anggota
                    </h3>
                    <p class="text-gradient" style="font-size: 36px; font-weight: 800; margin: 0;" data-counter="<%= count.user %>">0</p>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(0,0,0,0.05);">
                        <p style="color: #10B981; font-size: 13px; margin: 0; font-weight: 600;">
                            <i class="fas fa-arrow-up" style="margin-right: 4px;"></i>
                            Terdaftar di sistem
                        </p>
                    </div>
                </div>

                <!-- Admin Count Card -->
                <div class="stat-card">
                    <div class="stat-card-icon" style="background: linear-gradient(135deg, #DC143C 0%, #B91C1C 100%);">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <h3 style="font-size: 14px; color: #6B7280; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                        Total Admin
                    </h3>
                    <p class="text-gradient" style="font-size: 36px; font-weight: 800; margin: 0;" data-counter="<%= admin.length %>">0</p>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(0,0,0,0.05);">
                        <p style="color: #DC143C; font-size: 13px; margin: 0; font-weight: 600;">
                            <i class="fas fa-shield-alt" style="margin-right: 4px;"></i>
                            Pengelola sistem
                        </p>
                    </div>
                </div>

                <!-- Active Sessions Card -->
                <div class="stat-card">
                    <div class="stat-card-icon" style="background: linear-gradient(135deg, #10B981 0%, #059669 100%);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3 style="font-size: 14px; color: #6B7280; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">
                        Status Sistem
                    </h3>
                    <p style="font-size: 24px; font-weight: 800; margin: 0; color: #10B981;">
                        ONLINE
                    </p>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(0,0,0,0.05);">
                        <p style="color: #6B7280; font-size: 13px; margin: 0; font-weight: 600;">
                            <i class="fas fa-check-circle" style="margin-right: 4px; color: #10B981;"></i>
                            Berjalan normal
                        </p>
                    </div>
                </div>
            </div>

            <!-- Admin List Card -->
            <div class="glass-card" style="margin-bottom: 32px;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
                    <h2 class="text-gradient" style="font-size: 22px; margin: 0; font-weight: 800;">
                        <i class="fas fa-user-shield" style="margin-right: 8px;"></i>
                        Daftar Admin
                    </h2>
                    <span class="badge-glass badge-red" style="font-size: 13px; padding: 8px 16px;">
                        <i class="fas fa-users" style="margin-right: 6px;"></i>
                        <%= admin.length %> Admin
                    </span>
                </div>

                <% if (admin.length > 0) { %>
                    <div class="grid-responsive" style="gap: 16px;">
                        <% admin.forEach(function(adm) { %>
                            <div class="glass-card" style="padding: 20px; border: 2px solid rgba(220, 20, 60, 0.1); transition: all 0.3s ease;">
                                <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                                    <div class="avatar" style="width: 50px; height: 50px; background: linear-gradient(135deg, #DC143C 0%, #1E3A8A 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 20px; font-weight: 700; border: 3px solid white;">
                                        <%= adm.nama ? adm.nama.charAt(0).toUpperCase() : 'A' %>
                                    </div>
                                    <div style="flex: 1; min-width: 0;">
                                        <h3 style="margin: 0 0 4px 0; font-size: 16px; font-weight: 700; color: #1F2937; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                            <%= adm.nama || 'Admin' %>
                                        </h3>
                                        <p style="margin: 0; font-size: 13px; color: #6B7280; font-weight: 500;">
                                            @<%= adm.username || 'unknown' %>
                                        </p>
                                    </div>
                                </div>

                                <div style="padding: 12px; background: rgba(220, 20, 60, 0.05); border-radius: 12px; margin-bottom: 12px;">
                                    <p style="margin: 0 0 8px 0; font-size: 12px; color: #6B7280; font-weight: 600;">
                                        <i class="fas fa-envelope" style="margin-right: 6px; color: #DC143C;"></i>
                                        Email
                                    </p>
                                    <p style="margin: 0; font-size: 13px; color: #1F2937; font-weight: 600; word-break: break-all;">
                                        <%= adm.email || '-' %>
                                    </p>
                                </div>

                                <div style="display: flex; gap: 8px; align-items: center;">
                                    <span class="badge-glass badge-red" style="flex: 1; text-align: center;">
                                        <i class="fas fa-shield-alt" style="margin-right: 4px;"></i>
                                        Admin
                                    </span>
                                    <a href="/dashboard/edit/<%= adm._id %>" class="btn-action btn-edit" title="Edit Admin">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                <% } else { %>
                    <div style="text-align: center; padding: 48px 20px; background: rgba(220, 20, 60, 0.05); border-radius: 16px;">
                        <i class="fas fa-user-shield" style="font-size: 48px; color: #DC143C; margin-bottom: 16px; opacity: 0.5;"></i>
                        <p style="color: #6B7280; font-size: 16px; margin: 0; font-weight: 600;">Tidak ada admin terdaftar</p>
                    </div>
                <% } %>
            </div>

            <!-- Users Table -->
            <%- include('partials/table') %>
        </div>
    </main>

    <!-- Scripts -->
    <%- include('partials/script') %>
    <%- include('partials/footer') %>

    <script>
        // Refresh Data Function
        function refreshData() {
            const btn = event.currentTarget;
            const icon = btn.querySelector('i');
            
            btn.disabled = true;
            icon.style.animation = 'spin 1s linear infinite';
            
            setTimeout(() => {
                window.location.reload();
            }, 500);
        }

        // Auto-hide alerts after 5 seconds
        setTimeout(() => {
            const alerts = document.querySelectorAll('.alert-glass');
            alerts.forEach(alert => {
                alert.style.opacity = '0';
                alert.style.transform = 'translateX(100px)';
                setTimeout(() => alert.remove(), 400);
            });
        }, 5000);

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… Dashboard Admin loaded successfully');
        });
    </script>

    <style>
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .glass-card:hover {
            border-color: rgba(220, 20, 60, 0.3);
            box-shadow: 0 15px 40px rgba(220, 20, 60, 0.15);
        }

        @media (max-width: 768px) {
            .page-header h1 {
                font-size: 24px !important;
            }

            .stat-card {
                padding: 20px;
            }

            .stat-card p[data-counter] {
                font-size: 28px !important;
            }
        }
    </style>
</body>
</html>

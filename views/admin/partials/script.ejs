<!-- Font Awesome Icon -->
<script src="https://kit.fontawesome.com/7cc967098c.js" crossorigin="anonymous"></script>
<!-- Iconify -->
<script src="https://cdn.jsdelivr.net/npm/@iconify/iconify@2.2.1/dist/iconify.min.js"></script>
<!-- jQuery -->
<script src="/adminlte/plugins/jquery/jquery.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="/adminlte/plugins/jquery-ui/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
$.widget.bridge('uibutton', $.ui.button)
</script>
<!-- Bootstrap 4 -->
<script src="/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- ChartJS -->
<script src="/adminlte/plugins/chart.js/Chart.min.js"></script>
<!-- Sparkline -->
<script src="/adminlte/plugins/sparklines/sparkline.js"></script>
<!-- JQVMap -->
<script src="/adminlte/plugins/jqvmap/jquery.vmap.min.js"></script>
<script src="/adminlte/plugins/jqvmap/maps/jquery.vmap.usa.js"></script>
<!-- jQuery Knob Chart -->
<script src="/adminlte/plugins/jquery-knob/jquery.knob.min.js"></script>
<!-- daterangepicker -->
<script src="/adminlte/plugins/moment/moment.min.js"></script>
<script src="/adminlte/plugins/daterangepicker/daterangepicker.js"></script>
<!-- Tempusdominus Bootstrap 4 -->
<script src="/adminlte/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
<!-- Summernote -->
<script src="/adminlte/plugins/summernote/summernote-bs4.min.js"></script>
<!-- overlayScrollbars -->
<script src="/adminlte/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
<!-- AdminLTE App -->
<script src="/adminlte/dist/js/adminlte.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="/adminlte/dist/js/demo.js"></script>
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<script src="/adminlte/dist/js/pages/dashboard.js"></script>
<!-- bs-custom-file-input -->
<script src="/adminlte/plugins/bs-custom-file-input/bs-custom-file-input.min.js"></script>

<!-- DataTables  & Plugins -->
<script src="/adminlte/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/adminlte/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="/adminlte/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
<script src="/adminlte/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
<script src="/adminlte/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
<script src="/adminlte/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
<script src="/adminlte/plugins/jszip/jszip.min.js"></script>
<script src="/adminlte/plugins/pdfmake/pdfmake.min.js"></script>
<script src="/adminlte/plugins/pdfmake/vfs_fonts.js"></script>
<script src="/adminlte/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
<script src="/adminlte/plugins/datatables-buttons/js/buttons.print.min.js"></script>
<script src="/adminlte/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>

<!-- DataTables Initialization Script -->
<script>
$(function () {
  // Initialize DataTable untuk usersTable dengan fitur lengkap
  var table = $("#usersTable").DataTable({
    "responsive": true,
    "lengthChange": true,
    "autoWidth": false,
    "searching": true,
    "ordering": true,
    "info": true,
    "paging": true,
    "pageLength": 10,
    "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "Semua"]],
    "language": {
      "lengthMenu": "Tampilkan _MENU_ data per halaman",
      "zeroRecords": "Data tidak ditemukan",
      "info": "Menampilkan halaman _PAGE_ dari _PAGES_",
      "infoEmpty": "Tidak ada data yang tersedia",
      "infoFiltered": "(difilter dari _MAX_ total data)",
      "search": "Cari:",
      "paginate": {
        "first": "Pertama",
        "last": "Terakhir",
        "next": "Selanjutnya",
        "previous": "Sebelumnya"
      }
    },
    "buttons": [
      {
        extend: 'copy',
        text: '<i class="fas fa-copy"></i> Copy',
        className: 'btn btn-secondary btn-sm',
        exportOptions: {
          columns: ':not(.no-export)'
        }
      },
      {
        extend: 'csv',
        text: '<i class="fas fa-file-csv"></i> CSV',
        className: 'btn btn-success btn-sm',
        exportOptions: {
          columns: ':not(.no-export)'
        }
      },
      {
        extend: 'excel',
        text: '<i class="fas fa-file-excel"></i> Excel',
        className: 'btn btn-success btn-sm',
        exportOptions: {
          columns: ':not(.no-export)'
        }
      },
      {
        extend: 'pdf',
        text: '<i class="fas fa-file-pdf"></i> PDF',
        className: 'btn btn-danger btn-sm',
        exportOptions: {
          columns: ':not(.no-export)'
        },
        customize: function(doc) {
          doc.defaultStyle.fontSize = 9;
          doc.styles.tableHeader.fontSize = 10;
          doc.styles.tableHeader.fillColor = '#007bff';
        }
      },
      {
        extend: 'print',
        text: '<i class="fas fa-print"></i> Print',
        className: 'btn btn-info btn-sm',
        exportOptions: {
          columns: ':not(.no-export)'
        }
      }
    ],
    "dom": '<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>Brtip',
    "columnDefs": [
      { "orderable": false, "targets": -1 }
    ]
  });

  // Tambahkan tombol export ke container
  table.buttons().container().appendTo('#usersTable_wrapper .col-md-6:eq(0)');

  // Event handler untuk klik baris (preview biodata)
  $('#usersTable tbody').on('click', 'tr.clickable-row', function() {
    var data = $(this).data();
    
    // Isi data ke modal
    $('#preview-username').text(data.username || '-');
    $('#preview-nama').text(data.nama || '-');
    $('#preview-npm').text(data.npm || '-');
    $('#preview-email').text(data.email || '-');
    $('#preview-phone').text(data.phone || '-');
    $('#preview-role').html('<span class="badge badge-' + (data.role === 'admin' ? 'danger' : 'primary') + '">' + 
                            (data.role === 'admin' ? 'Admin' : 'User') + '</span>');
    $('#preview-time').text(data.time || '-');
    
    // Simpan ID user untuk tombol edit
    $('#btn-edit-from-modal').data('user-id', data.userId);
    
    // Tampilkan modal
    $('#biodataModal').modal('show');
  });

  // Event handler untuk tombol edit di modal
  $('#btn-edit-from-modal').on('click', function() {
    var userId = $(this).data('user-id');
    if (userId) {
      window.location.href = '/dashboard/edit/' + userId;
    }
  });

  // Initialize DataTable untuk example1 (jika ada)
  $("#example1").DataTable({
    "responsive": true,
    "lengthChange": false,
    "autoWidth": false,
    "buttons": ["copy", "csv", "excel", "pdf", "print", "colvis"]
  }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');

  // Initialize DataTable untuk example2 (jika ada)
  $('#example2').DataTable({
    "info": false,
    "autoWidth": false,
    "responsive": false,
    "searching": true,
    "ordering": true,
    "paging": true,
    "scrollX": true,
    "lengthChange": true,
    "lengthMenu": [[10, 20, 30, 40, 50, -1], [10, 20, 30, 40, 50, "Semua"]]
  });
});
</script>
</body>
</html>
